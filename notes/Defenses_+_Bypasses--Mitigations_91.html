<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Mitigations</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Mitigations</h1><br/><p><a name="XSS"></a><h1>XSS</h1></p><p><h2>Background</h2></p><p><h3>Types of XSS</h3></p><p>There are three main categories of <a href="Recon_+_Services--WebApp_12.html#XSS">XSS</a> (we don&#39;t count Self-XSS in this household).</p><p></p><p><span class="subheading">Stored XSS</span>: The injected script is permanently stored on the target server and served to users whenever they access the compromised page.</p><p></p><p><span class="subheading">Reflected XSS</span>: The malicious script is embedded in a URL and reflected off a web server to the victim’s browser when they click on the manipulated link.</p><p></p><p><span class="subheading">DOM-based XSS</span>: The attack occurs in the Document Object Model (DOM) of a web page’s client-side script, altering the structure and content of the page.</p><p></p><p><h2>Input Validation</h2></p><p>Always validate and sanitize user inputs before they’re used in any web page output.</p><p></p><p><h2>Output Encoding</h2></p><p>Ensure that user-generated content is encoded correctly before rendering it in HTML, JavaScript, or other contexts.</p><p></p><p><h2>Content Security Policy (CSP)</h2></p><p>Implement a CSP header to restrict the sources of executable scripts and mitigate the risk of unauthorized script execution.</p><p></p><p><h2>Web Application Firewall (WAF)</h2></p><p>Deploy a WAF to detect and block malicious input before it reaches your application.</p><p></p><p><h1>SSRF</h1></p><p>Defending against SSRF requires a combination of secure coding practices, strong network configuration, and vigilant monitoring.</p><p></p><p><h2>Background</h2></p><p><h3>Impact</h3></p><p></p><p><span class="subheading">Access Restricted Data</span>: Attackers can use SSRF to access sensitive data within an organization (e.g. DBs, APIs, &amp; internal resources), &amp; bypass restrictions (e.g. for Web App URLs &amp; subdomains).</p><p></p><p><span class="subheading">Network Scanning</span>: Exploiting SSRF, attackers can perform network scans from the victim server, potentially discovering vulnerable services.</p><p></p><p><span class="subheading">Remote Code Execution</span>: If the SSRF attack allows sending requests to a local service, it could lead to remote code execution, opening a door for further compromise.</p><p></p><p><span class="subheading">Denial of Service</span>: Attackers can exploit SSRF to flood external services with requests, leading to service disruptions.</p><p></p><p><span class="subheading">Forensic Countermeasures</span>: An attacker may be able to exploit SSRF to trick the server into doing the dirty work, thus obscuring the attacker&#39;s IP address from the target.</p><p></p><p><h2>Input Validation</h2></p><p>Always validate user inputs and ensure that URLs provided are trusted and safe.</p><p></p><p><h2>Whitelisting</h2></p><p>Employ a whitelist of allowed hosts or IP addresses that the server can communicate with.</p><p></p><p><h2>Network Segmentation</h2></p><p>Ensure proper network segmentation to limit access to internal resources and sensitive systems.</p><p></p><p><h2>Firewalls &amp; WAFs</h2></p><p>Implement firewalls and Web Application Firewalls (WAFs) to monitor and block malicious traffic.</p><p></p><p><h2>Access Controls</h2></p><p>Set strict access controls for services and APIs to prevent unauthorized requests.</p><p></p><p><h1>RCE</h1></p><p><h2>Background</h2></p><p><h3>Impact</h3></p><p></p><p><span class="subheading">Shell Injection</span>: Attackers can execute commands on the server, effectively gaining control over its environment.</p><p></p><p><span class="subheading">Data Theft</span>: Sensitive data can be stolen by reading files or accessing databases the server has access to.</p><p></p><p><span class="subheading">System Compromise</span>: RCE can lead to full system compromise if attackers gain administrative control.</p><p></p><p><span class="subheading">Propagation</span>: Attackers might use RCE as a stepping stone to further attack internal systems.</p><p></p><p><h2>Input Validation</h2></p><p>Always validate and sanitize user inputs before using them in any server-side execution.</p><p></p><p><h2>Code Review</h2></p><p>Regularly review your codebase for potential security vulnerabilities, including RCE.</p><p></p><p><h2>Use Frameworks Securely</h2></p><p>If using PHP frameworks, make sure you understand their security features and pitfalls.</p><p></p><p><h2>Disable Dangerous Functions</h2></p><p>Disable or restrict dangerous PHP functions that could be used in an RCE attack.</p><p></p><p><h2>Application Whitelisting</h2></p><p>Implement application whitelisting to allow only approved commands to be executed.</p></div>
</body>
</html>
