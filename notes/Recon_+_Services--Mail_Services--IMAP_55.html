<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>IMAP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>IMAP</h1><br/><p><h1>Background</h1></p><p>See <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-imap">Hacktricks</a> for other methods of authentication (e.g <span style="color:#ff0000;">Using NTLM Hash</span>) &amp; enumeration.</p><p></p><p><h2>Connect</h2></p><p><em>nc 192.168.152.140 143</em></p><p></p><p><h3>Authenticate</h3></p><p>For example, if the hostname used (e.g for TLS/SSL Certs) is localhost, then use-</p><p></p><p><em>tag login jonas@localhost SicMundusCreatusEst</em></p><p></p><p><h1>Enumerate</h1></p><p>After signing in, enumerate contents.</p><p></p><p><span style="color:#060f94;text-decoration:underline;">Note</span>: Some of the following <span style="color:#ff0000;">commands didn&#39;t work the 1st time</span>, &amp; either <span style="color:#ff0000;">returned an error or incorrect output</span> (e.g the output from the prev command). Not sure why, but <span style="color:#ff0000;">try re-running them as is</span>!</p><p></p><p><em>tag LIST &quot;&quot; &quot;*&quot;</em>				(Output: <strong>* LIST (\NoInferiors) &quot;/&quot; INBOX</strong>)</p><p></p><p><h2>List Emails</h2></p><p>The query used is based off of the output from the prev command (e.g <strong>INBOX</strong>).</p><p></p><p><em>tag SELECT INBOX</em></p><p></p><p><em>tag STATUS INBOX (MESSAGES)			</em>(Output: <strong>* STATUS INBOX (MESSAGES 5)</strong> This shows that there are 5 emails)<em></em></p><p><em></em><em></em></p><p><em></em><h3>Things to Look For</h3></p><p>Aside from the obvious (e.g Credentials, etc), make a list of <span style="color:#ff0000;">email addresses</span>. Even if the names aren&#39;t used as usernames on the Host System or other services (e.g WebApp, FTP, etc), they still may be useful for things like Phishing.</p><p></p><p>Look for references to <span style="color:#ff0000;">SW used</span>. Some may be vuln, or could give you insight into what Host System is used for. For ex-</p><p></p><p>If <strong>LibreOffice</strong> is mentioned, this likely means that it will accept <strong>.ods </strong>or <strong>.xls </strong>files, which could be used for a macro attack.<em></em></p><p><em></em><em></em></p><p><em></em><h3>Output Email Contents</h3><em></em></p><p><em></em><em></em></p><p><em>tag fetch 1 (BODY[1])</em>		(Fetch the Body of the 1st Email)</p><p></p><p><em>tag fetch 2:5 BODY[HEADER] BODY[1]</em>		(Fetch the Header &amp; the Body of Emails 2-5)</p></div>
</body>
</html>
