<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Squid Proxy</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Squid Proxy</h1><br/><p><h1>Background</h1></p><p>[SVC 28-29]</p><p></p><p><h1>Brute Force- HTTP Basic Auth</h1></p><p>Nmap has built-in script to Attack Proxies, but it may throw some false positives.</p><p></p><p><em>nmap --script http-proxy-brute IP -p3128 -v</em></p><p></p><p><em>nmap --script http-proxy-brute --script-args &quot;userdb=/dev/shm/squid_user,passdb=/usr/share/wordlists/rockyou.txt&quot; IP -p3128 -v</em></p><p></p><p>Theoretically, may be able to use standard <a href="Misc_Attacks--Password_Attack_5.html#WebApp Brute Force">HTTP Basic Auth BF</a> with <em>proxychains</em> or a built-in arg for proxies. Notice the HTTP Code is 407 for Proxy Auth, not the typical 401. Idk if this&#39;ll work.</p><p></p><p><em>patator http_fuzz auth_type=basic url=http://TARGET/ user_pass=admin:FILE0 0=/usr/share/wordlists/rockyou.txt -x ignore:code=407 proxy=SQUID_IP:3128 proxy_type=http</em></p><p></p><p><h1>Internal Port Scan</h1></p><p>Add the following line to your proxychains conf file (i.e <a href="file:///etc/proxychains4.conf">/etc/proxychains4.conf</a> or copy file to another location in proxychains search path).</p><p>Can <span style="color:#ff0000;">scan the localhost</span> itself, or use it to <span style="color:#ff0000;">scan other targets in the LAN</span>.</p><p></p><p><strong>http SQUID_IP 3128 USER PASSWD</strong></p><p></p><p>Use with Nmap like-</p><p></p><p><em>proxychains nmap -sT -n -p- localhost -v</em></p><p></p><p><h1>Access Internal Services</h1></p><p>May able to access some internal services using proxychains &amp; the Squid Proxy! FoxyProxy didn&#39;t seem to work.</p><p></p><p><h2>curl</h2></p><p>Authentication to the proxy itself is done with a diff arg than when Authenticaticating to the target site (e.g <strong>--proxy-user</strong> is one option, but it varies for diff Auth mechanisms).</p><p></p><p>However, it seemed buggy &amp; <span style="color:#ff0000;">worked better when curl was run through </span><strong><span style="color:#ff0000;">proxychains</span></strong><span style="color:#ff0000;"> without using any of the built-in proxy options</span>!</p><p></p><p><h2>FoxyProxy</h2></p><p>If you&#39;re accessing an HTTPS site, ensure that the FoxyProxy Proxy <strong>Type</strong> is <strong>HTTPS</strong> (not HTTP). {I think? It went from a blank page to an error regarding the TLS/SSL Cert which I couldn&#39;t resolve using normal means. proxychains curl -k worked though}</p><p></p><p><h1>Use with Burpsuite</h1></p><p><a href="Recon_+_Services--WebApp_12.html#burp upstream proxy">Burpsuite</a> itself can be setup to use a proxy like Squid. Setup your browser to point to burp, &amp; inside Burpsuite do the following- (Use <strong>*</strong> for all hosts)</p><p></p><p>Different <a href="https://security.stackexchange.com/questions/88841/configuring-burp-to-use-in-proxy-environment">option for SOCKS Proxy</a></p><p></p><p><h2>HTTP Proxy</h2></p><p><strong>Settings</strong> (Top Right) → <strong>Network</strong> ↓ <strong>Connections</strong>  ↓ <strong>Upstream Proxy Servers</strong></p></div>
</body>
</html>
